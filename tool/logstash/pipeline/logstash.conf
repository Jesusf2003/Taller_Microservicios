input {
	file {
		type => "log"
		path => "../../../order-service/logs/application.log"
	}
	rabbitmq {
		host => "rabbitmq"
        port => 5672
        heartbeat => 30
        durable => true
        exchange => "log-microservices"
        exchange_type => "direct"
        password => "vg123"
        user => "vg"
        queue => "log-microservices"
        type => "queue"
	}
}
filter {
	if [message] =~ "\tat" {
		grok {
      		match => ["message", "^(\tat)"]
      		add_tag => ["stacktrace"]
    	}
  	}
}

output {
	stdout {
		codec => rubydebug
	}

	elasticsearch {
		hosts => "elasticsearch:9200"
		user => "elastic"
		password => "elastic123"
        index => "log-%{+dd.MM.YYYY}"
    }
}